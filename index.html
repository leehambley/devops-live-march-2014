<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
      cite:before {
        content: "— ";
        color: silver;
      }
      cite {
        color: silver;
      }
      img {
        width: 80%;
      }
      #slide-projects img {
        width: 200px;
        vertical-align: middle;
      }
      #slide-whoami img {
        width: 250px;
      }
      #slide-loudmouth img {
        width: 80%;
      }
      #slide-hideously-chef img {
        width: 80%;
      }
      .rrdtool-release-list-screenshot img {
        width: 50%;
      }
      .greyed-out {
        opacity: .4;
      }
      .very-greyed-out {
        opacity: .1;
      }
      .asterisk {
        color: firebrick;
      }
      .dot:before {
        content: "• ";
      }
      .dot.red:before {
        color: red;
      }
      .dot.yellow:before {
        color: yellow;
      }
      .dot.green:before {
        color: green;
      }
    </style>
  </head>
  <body>
    <textarea id="source">

name: intro
class: center, middle

# A guided discussion about why we put up with hideously complex tools...

(or why open source tools tend towards complexity)

---

name: whoami

# `whoami`

![Lee Hambley](./images/lee-hambley-avatar.png)

* "Software Wizard"
* C, Go, Ruby, Javascript, Bash
* (HTML, CSS, Lua, Python, R.. you get the picture... *whatever works*)

---

name: projects

# Projects

* ## ![Capistrano Logo](http://capistranorb.com/images/CapistranoLogo.png)
  Widely used, widely <strike>hated</strike> *distrusted* tool. (at least, it feels that way, most of the time)

# Contributions

* ## LibSSH
  Ability to read-out SSH compiled config, and other (non-merged) changes to make writing a Ruby gem backed by pure-C possible.
* ## Rails
  Fixes for date time parameter parsing outside of Rails.
* ## `lib/pq` (PorstgreSQL driver, Go) &amp; Go Standard Library
  Fixes for error handling when abusing SQL. (new framework and language, lots of low hanging fruits)
* ### Lots of other less interesting stuff
  [ Stalk me on Github ]( https://github.com/leehambley ), [Twitter `@leehambley`](http://twitter.com/leehambley)

---

name: loudmouth

# Maintaining FOSS

You develop a thick skin and try to get used to reading things like this:

![capistrano-grief](./images/tweet-capistrano-grief.png)
![capistrano-grief](./images/tweet-horrible-documentation.png)

---

name: respect

# Respect

I want to be absolutely crystal clear.... I love all FOSS.

And I think that people are generally rather disrespectful about FOSS projects.

**I'm going to be calling out a few projects by name.**

--

(it's fair to say they are victims of their own success, and we've all run into them in the wild, and benefited, even if we didn't enjoy it)

--

# because they suck...

--

* they werent't invented here
* we didn't read the docs
* it was written in July 16, 1999 .asterisk[*]
* it's written in .thing[Java], and ... .thing[Java] sucks too
* it's difficult to install
* my distribution doesn't have a recent version in the package manager
* the tool has it's own package manager

--

[ `RRDTool` Release History, Wikipedia ]( http://en.wikipedia.org/wiki/RRDtool#Release_history )

.rrdtool-release-list-screenshot[![MRTG Done Right!](./images/rrdtool-release-list-mrtg-done-right.png)]

---

name: cams

# CAMS

* ### Culture

* ### Automation

* ### Measurement

* ### Sharing

---

name: am

# CAMS

* ### .very-greyed-out[ Culture ]

* ### Automation

* ### .greyed-out[ Measurement ]

* ### .very-greyed-out[ Sharing ]

---

name: hideously-complex

# Recognise this?

![attribute precedence part 1](http://docs.opscode.com/_images/overview_chef_attributes_precedence.png)
![attribute precedence part 2](http://docs.opscode.com/_images/overview_chef_attributes_table.png)

---

name: hideously-chef

# Yeah... it's Chef.

![chef-attribute-precedence](./images/chef-attribute-precedence.png)
[ http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence ]( http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence )

---

name: complex-solutions-complex-problems
class: center, middle

## Do complex problems demand complex solutions?

---

class: center, middle

## I trust that we're just solving the wrong problems.

---

class: center, middle

## What is the right problem?

--

![the truth is out there](http://astrofix.net/wp-content/uploads/2011/05/Optimized-the-truth-is-out-there-x-files-poster.jpg)

---

class: center, middle

In a config file..

--

.. and a bit of it in the database

--

and some of it in Git..

--

.. in a submodule

--

..ohh, except that bit

--

Only Keith knows where that is...

--

...and he's on Bora Bora surfing this month...

---

class: middle

# Truth...State...

> Remember (old-timer?) Linux user typing commands into terminal that goes and mutates the state of the Linux machine. They'll go and stop a process, change configuration file and start the process again. They're the one connecting to the machine and making sure the state of the Linux machine is mutated correctly. Let's call this method Imperative Configuration.
>
> <cite>Domen Kožar</cite>

[https://www.domenkozar.com/2014/03/11/why-puppet-chef-ansible-arent-good-enough-and-we-can-do-better/](https://www.domenkozar.com/2014/03/11/why-puppet-chef-ansible-arent-good-enough-and-we-can-do-better/)

---

class: middle

# Truth...State...

> Remember (old-timer?) Linux user **typing** commands into terminal that goes and **mutates the state** of the Linux machine. They'll go and stop a process, change **configuration file** and start the process again. They're the one connecting to the machine and **making sure the state of the Linux machine is mutated correctly**. Let's call this method **Imperative Configuration**.
>
> <cite>Domen Kožar</cite>

[https://www.domenkozar.com/2014/03/11/why-puppet-chef-ansible-arent-good-enough-and-we-can-do-better/](https://www.domenkozar.com/2014/03/11/why-puppet-chef-ansible-arent-good-enough-and-we-can-do-better/)

---

class: middle

# Types of complexity...

* ## Installation Complexity
* ## Operational Complexity
* ## Data Complexity

---

class: middle

* ## Installation Complexity

  * #### Jenkins
    * **YAY** Low complexity, single `.jar` runnable without any special config
    * **YAY** Widely, and well packaged, essentially every OS and platform
    * **OHH** Pluigins! Easy to install, but then you are meddling with state
  * #### Graphite
    * **YAY** No plugins!
    * **OHH** Python, speaking as a Ruby developer, and because if your app runs on Python, you'll have more problems, or have to use `pvm` or something to isolate your operational, and development Pyton needs
    * **OHH** Three pieces, plus whichever frontend you decide to use, the bundled one is terrible
    * **ARGH** Tricky to install, hundreds of Mb of deps, hundreds and hundreds and files
  * #### ElasticSearch
    * **YAY** Index config all done via HTTP API (or binary, Java protocol)
    * **YAY** Low complexity, single `.jar` runnable without any special config
    * **YAY** Widely, and well packaged, essentially every OS and platform
    * **OHH** Pluigins! Easy to install, but then you are meddling with state

--

.asterisk[*] I really like ElasticSearch, and my company is releasing a product that fulfils a deployment niche poorly, and unintionally addressed by Jenkins

---

class: middle

* ## Operational Complexity

  * #### Jenkins
    * **ARGH** Job config done via web forms... but one can still drop `.xml` files on disk, and restart Jenkins to pick them up, nothing to stop you editing them in the web interface
  * #### Graphite
    * **YAY** No plugins!
    * **YAY** Graphite will accept any metrics, from any host that you throw at it, no-host list manifest needed!
    * **OHH** But, the retention rates have to be defined up front, and aren't as simple as they could be
  * #### ElasticSearch
    * **YAY** It uses multicast DNS and dns-sd ([http://www.dns-sd.org/](http://www.dns-sd.org/)) to configure it's own load balancing cluster, automatically!
    * **OHH** Changing a mapping for a given field is tricky, but that's more or less because it's tricky all the way down to Lucene, and the better way to handle it is to recreate a new index version, and alias it. Much like the 'current' symlink which links to a timestamped release folder in Capistrano deployed environments.
    * **ARGH** Some surprising bugs arising from Lucene (e.g timeouts *can't* apply to the highligh matching phase of queries, leading to never-ending queries)

--

.asterisk[*] That's _less_ fun when sharing an office with someone who is running integration tests, and ElasticSearch decides that _you_ are their slave, and your database seems to be taking it's contents from the _I'm Feeling Lucky_ button at Google.

---

class: middle

* ## Data Complexity

  * #### Jenkin
    * **OHH** Some APIs for job build state
    * **ARGH** No real APIs for getting all job build stauts, output, config, changes, etc, etc, et
  * #### Graphite
    * **ARGH** You can get the data for any given graph as JSON, or CSV via the `?format=` query string parameter, but no real *export* API.
    * ... that is, no way to enumerate all metrics, all hosts, all time series, ranges, events, etc.
    * **OHH** No concept of *Events*, the workaround for tagging is the `drawAsInfinite()` function.
    * **OHH** Data is down sampled, eventaully, but at least you can configure when and to what resolution, the downsampling also compromises exportability.
  * #### ElasticSearch
    * **YAY** No data lost, ever. ElasticSearch keeps the source document posted forever.
    * **YAY** Built in backup and restore and snapshotting API, alias support for quick database swaps.

---

class: center, middle

# We have complicated jobs.

--

(and it's getting more complicated all the time)

---

class: center, middle

## Running application has become an order of magnitude more complicated than *building* it.

---

![logjam](./images/logjam-masked.png)

This is LogJam, a FOSS tool written by Stefan Kaes, chief architect at *probably* one of the biggest Rails sites in the world.

The Rails apps at that company are built with a pretty solid SOA but require forty different variables to be correctly set for *each environment* to reach their various REST API peers and databases, etc.

The app that produced the stats above is *4,000* lines of Ruby, and **83,000** lines of YAML.

* [https://github.com/search?q=%40skaes+logjam](https://github.com/search?q=%40skaes+logjam)

---

class: center, middle

![I <3 Randal Monroe ](http://imgs.xkcd.com/comics/manuals.png)

---

class: center, middle

## What do we need?

---

class: center, middle

## What am I betting on in the next 5 years?

---

class: center, middle

### Go Lang

--

Rob Pike's work fascinates me. I am in awe of how he makes everything look effortless.

--

### [Linux-]Containers

--

Making it easier to setup and burn down scripted environments.

--

### Renewed interest in DNS, and distributed state engines

--

Hat tip to [Hashi Corp's Serf](http://www.serfdom.io/) in this space

--

### [RAFT](http://raftconsensus.github.io/)

--

The PAXOS paper was incomprehensible, RAFT is actually a plesant read.

--

### [http://www.harrow.io](https://www.harrow.io/)

My company's product, launching soon to address some of the peripheral problems of devops.
<br />
I'm rather literally betting my company on it.

--

### *coin

--

We're already proving that this can work, blockchains building a trust and influence based version of Git that is more suited to system concensus rather than human intent.

Not just Bitcoin and altcoint with their proof of work, and finite resources, but also the BitTorrent distributed discovery protocols and hash tables, and "public secret" networks such as BTSync.

---

class: center, middle

# Is there one project where we can shoehorn these ideas in, and build something useful?

---

class: center, middle

# `#lazyweb`

---

```
$ ./time-series-database
> Listening on 8181
```

I want this tool for every shell script, import job, `dd`, backup restoration, and whatever else I write, and throw away a few times a week.

I imagine an API like:

```
$ tsdrecord some.event 123
```

--

How should `tsdrecord` know where there's a server?

--

By using dns-sd.

--

We should be able to able to do something like this:

```
$ curl localhost:8081/metrics
{.... who knows ....}
```

--

Because we could expose a UDP and TCP binary protocol, and a JSON HTTP protocol all on the same port, and let the client figure out what it wants to have.

--

We would also be able to do this:

```
$ tsdweb
> Listening on 8282
$ open localhost:8282
```

--

And see a web interface were we could build graphs, and explore it easily, alternative frontends could use dns-sd to look for compatible backends, and make them available with alternative UIs. In a perfect world, imagine the UI could use a `dns-sd` discovered store, or fallback to Git on disk.

--

And I'd like to use the same tool, all the way up until I need to hire a dedicated ops team, who can manage that for me.

--

Eventually, I'll probably write it...

---

class: center, middle

# If <sup>I <sup>ever <sup>stop <sup>complaining</sup></sup></sup></sup>

---

<script type="text/javascript" src="//www.google.com/trends/embed.js?hl=en-US&q=elasticsearch,+solr,+lucene&cmpt=q&content=1&cid=TIMESERIES_GRAPH_0&export=5&w=500&h=330"></script>

</textarea>

    <script src="http://gnab.github.io/remark/downloads/remark-0.6.1.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create();
    </script>
  </body>
</html>
